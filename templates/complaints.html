<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!--Bootstrap-->
    <link rel="stylesheet" href="/static/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="/static/css/sidebar.css">  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.datatables.net/2.0.6/css/dataTables.bootstrap5.css">
    <link rel="stylesheet" href="https//cdn.datatables.net/2.0.6/css/dataTables.dataTables.min.css">
    <title>Document</title>
</head>
<body>
    <div class="container-fluid">
        <div class="row">

       
        
        <!--sidebar-->
        <div class="col-lg-2 position-fixed  " style="  box-shadow: 2px 0 5px rgba(0, 0, 0, 0.2); height: 100%; background-color: #1D1D42;">
        

          <div class="list-group">

            <button type="button" style="color: white; background-color: #1D1D42;" class="list-group-item list-group-item-action mt-4" aria-current="true">
              
          <h2 >Admin</h2>
             </button>
                  <button type="button" onclick="redirectToDashboard()" style="  color: #72728A; background-color:#1D1D42;" class="list-group-item list-group-item-action mt-4" aria-current="true">
                  <span class="fa fa-home" style="margin-right: 8px; font-size: 20px;"></span>
              <span style="font-weight: 600; ">Dashboard</span>
                  </button>

                <button type="button" onclick="redirectToTicket()" style="  color: #72728A; background-color: #27274F;" class="list-group-item list-group-item-action mt-4" aria-current="true">
                  <span class="fa fa-ticket" style="margin-right: 8px; font-size: 20px;"></span>
              <span style="font-weight: 600; ">Ticket</span>
                 </button>
                
         
               
               
              </div>

        </div>
        <div class="col-lg-10 offset-lg-2" style="background-color: #F4F7FE; height: 100vh;">
            <div class="mt-2">
              <h3 style="font-weight: 600;">Tickets</h3>
            </div>
            <div class="mt-3"></div>

              <!--Unresolved-->
          <div class="row mt-3 ">
            <div class=" col-lg-3">
              <div class="card" style="box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);"   >
                  <div class="top">
                   
                  </div>
                  <div class="card-body ">
                      <div class="icon-number">
                        <div class="text-title">
                          <h5 class="card-title" style="font-weight: bold;">Open</h5>
                        </div>
                          <div class="number-icon" style="display: flex; justify-content: space-between;">
                              <h3 style="font-weight:bold; color: #444446;">{{ total_users }}</h3>
                              <img src="/static/img/BiTicketPerforatedFill.svg" alt="" style="height: 50px;" >
                          </div>
                      
                      </div>
                   
                  </div>
              </div>
          </div>

          <div class=" col-lg-3">
            <div class="card" style="box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);"  >
                <div class="top">
                 
                </div>
                <div class="card-body ">
                    <div class="icon-number">
                      <div class="text-title">
                        <h5 class="card-title" style="font-weight: bold;" >Unresolved</h5>
                      </div>
                        <div class="number-icon" style="display: flex; justify-content: space-between;">
                          <h3 style="font-weight:bold; color: #444446;">{{total_complaints}}</h3>
                          <img src="/static/img/CarbonIncompleteError.svg" alt="" style="height: 50px;">
                        </div>
                    
                    </div>
                 
                </div>
            </div>
        </div>

        <div class=" col-lg-3">
          <div class="card" style="box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);"  >
              <div class="top">
                 
              </div>
              <div class="card-body ">
                  <div class="icon-number">
                    <div class="text-title">
                      <h5 class="card-title" style="font-weight: bold;">Unassigned</h5>
                    </div>
                      <div class="number-icon" style="display: flex; justify-content: space-between;">
                        <h3 style="font-weight:bold; color: #444446;">{{total_complaints}}</h3>
                        <img src="/static/img/MaterialSymbolsPending.svg" alt="" style="height: 50px;">
                      </div>
                  
                  </div>
               
              </div>
          </div>
      </div>

      <div class=" col-lg-3">
        <div class="card" style="box-shadow: 0px 0px 10px rgba(0, 0, 0, 0.1);" >
            <div class="top">
              
            </div>
            <div class="card-body ">
                <div class="icon-number">
                  <div class="text-title">
                    <h5 class="card-title" style="font-weight: bold;">Resolved(Today)</h5>
                  </div>
                    <div class="number-icon" style="display: flex; justify-content: space-between;">
                      <h3 style="font-weight:bold; color: #444446;">0</h3>
                      <img src="/static/img/WhhIssueclosed.svg" alt="" style="height: 50px;">
                    </div>
                
                </div>
             
            </div>
        </div>
    </div>  

      </div>

      <div class="mt-3"></div>
            <table id="example" class="  mt-3 complaints-table table table-striped" style="   border-collapse: separate;
            border-spacing: 0; border-radius: 10px; overflow: hidden; background-color: #EDEDED; width: 100%;">
                <thead>
  <tr>
    <th scope="col">Ticket ID</th>
    <th scope="col">Consumer</th>
    <th scope="col">Description</th>
    <th scope="col">Municipality</th>
    <th scope="col">Barangay</th>
    <th scope="col">Date Reported</th>
    <th scope="col">Status</th>
    <th scope="col">Action</th>

    
  </tr>
</thead>
  <tbody class="table-group-divider">
    {% for complaint in complaints %}
  <tr>
   
    <td style=" color: #72728A;">{{ complaint['$id'] }}</td>
    <td>{{ complaint['consumer_name'] }}</td> <!-- consumer name -->
    <td>{{ complaint['description'] }}</td> <!-- Description -->
    <td>{{ complaint['city'] }}</td> <!-- City -->

    <td>{{ complaint['barangay'] }}</td> <!-- Barangay -->
 
    <td>{{ complaint['createdAt'][:10] }} {{ complaint['createdAt'][11:16] }}</td> <!-- Date Reported --> 
    <td class="text-secondary">{{ complaint['status'] }}</td> <!--Status-->
  

      <td>
        <button type="button" class="btn btn-secondary" style="width: 100%;" data-bs-toggle="modal" data-bs-target="#exampleModal">
            Assign Crew
          </button>
          <!--Modal-->
          <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-xl">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="exampleModalLabel">Crews</h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <div class="col-lg-12 bg-primary">
                    <table class="table table-bordered border-primary">
                        <thead>
          <tr>
            <th scope="col">Image</th>
            <th scope="col">Name</th>
            <th scope="col">Expertise</th>
            <th scope="col">Assigned Location</th>
            <th scope="col">Ratings</th>
          </tr>
        </thead>
          <tbody class="table-group-divider">
          <tr>
        
            <td>Mukhan ng crew</td>
            <td>Name ng crew</td>
            <td>di pa sure</td>
            <td>Pagsanjan</td>
            <td>di pa sure</td>
            <td>
                <button class="btn btn-secondary" data-bs-target="#exampleModalToggle2" style="width: 100%;" data-bs-toggle="modal">Assign</button>
            </td>
           
            
         
          </tr>

      
        </tbody>
        
        
                  </table>
                  </div>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                  <button type="button" class="btn btn-primary">Save changes</button>
                </div>
              </div>
            </div>
          </div>

          <!--Second modal for assigning crew-->
          <div class="modal fade" id="exampleModalToggle2" aria-hidden="true" aria-labelledby="exampleModalToggleLabel2" tabindex="-1">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="exampleModalToggleLabel2">Name of crew/team</h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  <div class="col-lg-12 ">
                    <input type="text" class="form-control mt-2" placeholder="ID" aria-label="Recipient's username" aria-describedby="basic-addon2">
                    <input type="text" class="form-control mt-2" placeholder="Consumer" aria-label="Recipient's username" aria-describedby="basic-addon2">
                    <input type="text" class="form-control mt-2" placeholder="Description" aria-label="Recipient's username" aria-describedby="basic-addon2">
                    <input type="text" class="form-control mt-2" placeholder="Location" aria-label="Recipient's username" aria-describedby="basic-addon2">
                    <input type="text" class="form-control mt-2" placeholder="Level of prioritization: High" aria-label="Recipient's username" aria-describedby="basic-addon2">
                    <input type="text" class="form-control mt-2" placeholder="Date reported" aria-label="Recipient's username" aria-describedby="basic-addon2">
                   
                  </div>
                </div>
                <div class="modal-footer">
                  <button class="btn btn-primary" data-bs-target="#exampleModalToggle" data-bs-toggle="modal">Send</button>
                </div>
              </div>
            </div>
          </div>
    </td>
  </tr>
  {% endfor %}  
  

</tbody>

          </table>
          <div class="mb-3"></div>
            
        </div>
    </div>

    </div>
    <!--CHange route-->
  <script>
    function redirectToDashboard() {
    window.location.href = "/"; // Redirect to the Flask route
  }
  function redirectToTicket() {
    window.location.href = "/complaints"; // Redirect to the Flask route
  }
</script>
    <!--bootstrap-->
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!--DataTable-->
    <script src="https://cdn.datatables.net/2.0.6/js/dataTables.js"></script>
    <script src="https://cdn.datatables.net/2.0.6/js/dataTables.bootstrap5.js"></script>
    <script>
      $(document).ready(function() {
        $('#example').DataTable({
          // Add custom pagination button styling
          buttons: [
            {
              extend: 'previous',
              className: 'btn-secondary'
            },
            {
              extend: 'next',
              className: 'btn-secondary'
            }
            // Add more customization options as needed
          ]
        });
      });
      
    </script>

</body>
</html>